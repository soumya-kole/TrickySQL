# Objective

Calculate moving average for stock data.
We will calculate 5 day and 10 day moving average

## Data preparation

```sql
CREATE TABLE demo.stock_data (
    id INT AUTO_INCREMENT PRIMARY KEY,
    symbol VARCHAR(10),
    date DATE,
    open DECIMAL(10, 2),
    high DECIMAL(10, 2),
    low DECIMAL(10, 2),
    close DECIMAL(10, 2),
    volume INT
);
INSERT INTO demo.stock_data (symbol, date, open, high, low, close, volume) VALUES
    ('AAPL', '2023-10-01', 145.50, 148.20, 144.50, 147.80, 63258456),
    ('AAPL', '2023-09-30', 144.20, 146.50, 143.80, 145.90, 54009876),
    ('AAPL', '2023-09-29', 142.50, 145.60, 142.20, 144.70, 49834567),
    ('AAPL', '2023-09-28', 141.80, 144.40, 141.50, 143.20, 56781234),
    ('AAPL', '2023-09-27', 142.30, 143.40, 141.70, 142.10, 47621345),
    ('AAPL', '2023-09-26', 141.40, 142.80, 140.90, 142.50, 45239876),
    ('AAPL', '2023-09-25', 140.90, 142.20, 140.50, 141.80, 42165789),
    ('AAPL', '2023-09-24', 140.30, 141.20, 139.80, 140.90, 39874567),
    ('AAPL', '2023-09-23', 139.80, 140.70, 139.40, 140.20, 38562134),
    ('AAPL', '2023-09-22', 139.60, 140.10, 139.00, 139.80, 35678234),
    ('AAPL', '2023-09-21', 138.80, 139.90, 138.50, 139.60, 42198765),
    ('AAPL', '2023-09-20', 139.00, 139.50, 138.30, 139.10, 37894567),
    ('AAPL', '2023-09-19', 138.70, 139.40, 138.20, 139.00, 39987654),
    ('AAPL', '2023-09-18', 138.40, 138.90, 137.80, 138.60, 36981234),
    ('AAPL', '2023-09-17', 138.20, 138.70, 137.90, 138.40, 35213456),
    ('AAPL', '2023-09-16', 138.50, 139.20, 138.00, 138.20, 38764567),
    ('AAPL', '2023-09-15', 138.10, 138.90, 137.60, 138.50, 39873456),
    ('AAPL', '2023-09-14', 137.80, 138.30, 137.10, 138.10, 36541234),
    ('AAPL', '2023-09-13', 137.30, 138.00, 137.00, 137.80, 34987654),
    ('AAPL', '2023-09-12', 137.40, 137.70, 136.80, 137.30, 36234567);
INSERT INTO demo.stock_data (symbol, date, open, high, low, close, volume) VALUES
    ('IBM', '2023-10-01', 128.60, 130.20, 128.00, 129.80, 45789234),
    ('IBM', '2023-09-30', 127.80, 129.60, 127.50, 129.10, 38974567),
    ('IBM', '2023-09-29', 126.50, 128.30, 126.20, 127.90, 41237654),
    ('IBM', '2023-09-28', 125.90, 127.80, 125.70, 127.00, 34891234),
    ('IBM', '2023-09-27', 126.10, 126.80, 124.90, 125.40, 39823456),
    ('IBM', '2023-09-26', 125.20, 126.30, 125.00, 126.10, 36781234),
    ('IBM', '2023-09-25', 125.00, 125.80, 124.70, 125.30, 34215678),
    ('IBM', '2023-09-24', 124.70, 125.40, 124.30, 125.00, 31894567),
    ('IBM', '2023-09-23', 124.40, 124.90, 124.10, 124.70, 32987654),
    ('IBM', '2023-09-22', 124.20, 124.70, 123.90, 124.40, 31234567),
    ('IBM', '2023-09-21', 123.80, 124.30, 123.60, 124.20, 33781234),
    ('IBM', '2023-09-20', 123.50, 124.00, 123.30, 123.80, 32456789),
    ('IBM', '2023-09-19', 123.40, 123.80, 123.20, 123.50, 31982345),
    ('IBM', '2023-09-18', 123.20, 123.60, 123.00, 123.40, 29874567),
    ('IBM', '2023-09-17', 123.00, 123.40, 122.80, 123.20, 31234567),
    ('IBM', '2023-09-16', 122.80, 123.20, 122.60, 123.00, 30781234),
    ('IBM', '2023-09-15', 122.70, 123.00, 122.40, 122.80, 29567890),
    ('IBM', '2023-09-14', 122.50, 122.90, 122.30, 122.70, 28894567),
    ('IBM', '2023-09-13', 122.30, 122.70, 122.20, 122.50, 27654321),
    ('IBM', '2023-09-12', 122.20, 122.40, 122.10, 122.30, 26981234);

```

## Further reading

[Mysql official page](https://dev.mysql.com/doc/refman/8.0/en/window-functions-frames.html)
